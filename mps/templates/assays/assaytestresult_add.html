{% extends "base.html" %}
{% load static %}

{% block load %}
<script src="{% static "js/inline_add.js" %}"></script>
<script src="{% static "js/cookies.js" %}"></script>
<script src="{% static "js/whittle.js" %}"></script>
<script src="{% static "assays/customize_chip_results_admin.js" %}"></script>
{% endblock %}

{% block content %}

<form class="form-horizontal" method="post" >
    {% csrf_token %}
    <h1>Add Chip Test Results <button type="submit" class="btn btn-primary">Submit</button></h1>

    <legend>Test Results</legend>

    {#    <p>Study: {{ form.assay_device_readout }}</p>#}

    {% if form.errors %}
        {% for field in form %}
            {% if field.errors %}
                {% for error in field.errors %}
                    <div class="alert alert-danger" role="alert">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        <span class="sr-only">Error:</span>
                        {{field.label}}: {{error}}
                    </div>
                {% endfor %}
            {% endif %}
        {% endfor %}
    {% endif %}

    <div class="form-group">
        <label for="study" class="col-sm-2 control-label">Study</label>
        <div class="col-sm-10">
          {{ form.assay_device_readout }}
        </div>
    </div>

    {{ formset.management_form }}
    <legend>Results</legend>

    {% if formset.non_field_errors %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            {{ formset.non_field_errors }}
        </div>
    {% endif %}

    <a id="add_button">Add Result</a>
    <table class="table table-striped results" id="assayresult_set-group" name="inlines">
        <thead>
            <tr><td>Readout</td><td>Pos/Neg</td><td>Function</td><td>Measure</td><td>Value</td><td>Test Unit</td><td>Severity</td><td>Delete</td></tr>
        </thead>
        <tbody>
            {% for result in formset %}
                <tr class="inline" id="results-{{ forloop.counter0 }}"><td>{{ result.assay_name }}</td><td>{{ result.result }}</td><td>{{ result.result_function }}</td><td>{{ result.result_type }}</td><td>{{ result.value }}</td><td>{{ result.test_unit }}</td><td>{{ result.severity }}</td><td>{{ result.DELETE }}</td></tr>
            {% endfor %}
        </tbody>
    </table>
</form>

{% endblock %}
